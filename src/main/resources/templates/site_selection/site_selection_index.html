<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
    <meta charset="UTF-8"/>
    <title>Thymeleaf</title>
    <head>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.css" />
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js"></script>
        <link rel="stylesheet" href="https://cache.amap.com/lbs/static/main.css"/>
        <script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
        <script src="../static/semantic/out/semantic.js" th:src="@{/semantic/out/semantic.js}"></script>
        <script type="text/javascript" src="https://webapi.amap.com/maps?v=1.4.14&key=e70e70fc0c617d13aa771071fa154138&&plugin=AMap.Geocoder"></script>

        <script rel="script" th:src="@{/js/utils.js}"></script>

        <link rel="stylesheet" href="../static/css/site_selection.css" th:href="@{/css/site_selection.css}"/>
        <link rel="stylesheet" type="text/css" href="../static/semantic/out/semantic.css" th:href="@{/semantic/out/semantic.css}" />
    </head>
    <body>
        <div class="ui container">
            <div class="ui large icon input">
                <input id="tipinput" name="searchAddress" type="text" value="请输入关键字：(选定后搜索)" onfocus='this.value=""'>
                <i class="link search icon"  onclick="getEvaluationBarResult(document.getElementById('tipinput').value)"></i>
            </div>
        </div>
        <div class="picture-content ui container">
            <div class="ui stackable equal width grid">
                <div class="ten wide column">
                    <div th:replace="site_selection/fragments/auto_navi_map :: map"></div>
                </div>
                <div class="six wide column">
                    <div th:replace="site_selection/fragments/bar_chart :: bar"></div>
                </div>
            </div>
        </div>
        <div class="ui container">
            <div class="ui stackable equal width grid">
                <div class="ten wide column">
                    <div id="tab_info" class="evaluation-content" th:include="site_selection/fragments/tab_info :: table"></div>
                </div>
                <div class="six wide column">
                    <div id="compare_bar" th:include="site_selection/fragments/bar_chart :: compareBar"></div>
                </div>
            </div>
        </div>

    </body>


    <script th:inline="javascript">
        getEvaluationBarResult = function(searchAddress) {
            $.ajax({
                url: "/site_selection_bar",
                type: 'get',
                contentType: 'application/json',
                data: {instituteName : searchAddress},
                async: true,
                success: function(data){
                    $("#tab_info").html(data);
                    console.log([reponseFromServer.barData]);
                    bar_result = [reponseFromServer.barData];
                    $.fn.drawBar(bar_result);
                },
                error: function (data) {
                    console.log('error: ' + data);
                }
            });
        };


        var hasSetMainSite = false;
        compareSite = function () {
            // if (!hasSetMainSite) {
            //     hasSetMainSite = true;
            // }
            var ctx = document.getElementById('siteCompare');
            ctx.height = (window.innerHeight*0.4);
            var myChart = new Chart(ctx, {
                type: 'horizontalBar',
                data: {
                    labels: ['地铁轻轨', '公交车站', '停车场', '一线早教', '普通早教', '异业机构', '居民户数', '平均房价', '平均修建年份'],
                    datasets: [{
                        label: '武汉大学',
                        data: [12, 19, 3, 5, 2, 3],
                        backgroundColor: [
                            'rgba(255, 99, 132, 0.2)',
                            'rgba(54, 162, 235, 0.2)',
                            'rgba(255, 206, 86, 0.2)',
                            'rgba(75, 192, 192, 0.2)',
                            'rgba(153, 102, 255, 0.2)',
                            'rgba(255, 159, 64, 0.2)'
                        ],
                        borderColor: [
                            'rgba(255, 99, 132, 1)',
                            'rgba(54, 162, 235, 1)',
                            'rgba(255, 206, 86, 1)',
                            'rgba(75, 192, 192, 1)',
                            'rgba(153, 102, 255, 1)',
                            'rgba(255, 159, 64, 1)'
                        ],
                        borderWidth: 1
                    },{
                        label: '华中科技大学',
                        data: [-12, -1, -3, -15, -22, -3],
                        backgroundColor: [
                            'rgba(255, 99, 132, 0.2)',
                            'rgba(54, 162, 235, 0.2)',
                            'rgba(255, 206, 86, 0.2)',
                            'rgba(75, 192, 192, 0.2)',
                            'rgba(153, 102, 255, 0.2)',
                            'rgba(255, 159, 64, 0.2)'
                        ],
                        borderColor: [
                            'rgba(255, 99, 132, 1)',
                            'rgba(54, 162, 235, 1)',
                            'rgba(255, 206, 86, 1)',
                            'rgba(75, 192, 192, 1)',
                            'rgba(153, 102, 255, 1)',
                            'rgba(255, 159, 64, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        yAxes: [{
                            ticks: {
                                beginAtZero: true
                            },
                            barPercentage: 0.5,
                            barThickness: 12,
                        }],
                        xAxes: [{
                            ticks: {
                                display: false
                            }
                        }]
                    }
                }
            });
        }

    </script>
    <script rel="script" th:src="@{/js/site_selection.js}"></script>
</html>

